
local plymeta = FindMetaTable("Player")

function plymeta:GetCampPosStreak()
    if not self.PPosCache then return 0 end
    
    local lpos
    local mindistnum = 0
    
    local distreq = 256
            
    for i=#self.PPosCache, 1, -1 do
        local pos = self.PPosCache[i]
        if lpos then
            local dist = pos:Distance(lpos)
            if dist > distreq then break end
            mindistnum = mindistnum + 1
        end
        lpos = pos
    end
    
    return mindistnum
end

timer.Create("plyposcache", 5, 0, function()
    for _,ply in pairs(player.GetAll()) do
        if ply:IsActivePlayer() then
            ply.PPosCache = ply.PPosCache or {}
            table.insert(ply.PPosCache, ply:GetPos())
        end
    end
end)