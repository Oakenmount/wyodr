timer.Create("checkafkspecs", 5, 0, function()
    local maxslots = cvars.Number("sv_visiblemaxplayers")
    
    for _,ply in pairs(player.GetAll()) do
        if ply:Team() == TEAM_SPECTATOR then
            ply.JoinedSpec = ply.JoinedSpec or CurTime()
        else
            ply.JoinedSpec = nil
        end
        
        if ply.JoinedSpec and #player.GetAll() >= (maxslots-2) then
            if (CurTime()-ply.JoinedSpec) > (10*60) and ply:GetUTimeTotalTime() < (60*60*12) then
                ply:Kick("Sorry! Been AFK for too long.")
            end
        end    
    end
end)